<!DOCTYPE html>
<html>
    <head>
      <!--Load the AJAX API-->
      <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
      <script type="text/javascript">
  
        // Load the Visualization API and the corechart package.
        google.charts.load('current', {'packages':['corechart']});
  
        // Set a callback to run when the Google Visualization API is loaded.
        google.charts.setOnLoadCallback(init);

        function getData(cb) {
            // $.ajax({
            //     url: "https://my.api.mockaroo.com/chart.json?key=e86ebea0",
            //     method: "GET",
            //     success: function(result) {
            //         cb(result);
            //     }
            // });
            cb(
                [
                    {
                        "id":1,
                        "colName":"ut",
                        "slices":178,
                        "cost":649
                    },
                    {
                        "id":2,
                        "colName":"nulla neque",
                        "slices":149,
                        "cost":558
                    },
                    {
                        "id":3,
                        "colName":"vestibulum eget",
                        "slices":175,
                        "cost":715
                    },
                    {
                        "id":4,
                        "colName":"eu pede",
                        "slices":115,
                        "cost":500
                    },
                    {
                        "id":5,
                        "colName":"lacinia",
                        "slices":124,
                        "cost":396
                    }
                ]
            );
        }

        function init() {
            handlePieChart();
            // handleComboChart();
            // handleLineChart();
            // handleColumnChart();
        }

        function handlePieChart() {
            var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
            getData(function(result) {
                var data = setupData(result);
                var options = getOptions();
                worker(chart, data, options);
            });
        }

        function handleLineChart() {
            var chart = new google.visualization.LineChart(document.getElementById('chart_div2'));
            getData(function(result) {
                var data = setupData(result);
                var options = getOptions();
                worker(chart, data, options);
            });
        }

        function handleColumnChart() {
            var chart = new google.visualization.ColumnChart(document.getElementById('chart_div3'));
            getData(function(result) {
                var data = setupData(result);
                var options = getOptions();
                worker(chart, data, options);
            });
        }

        function handleComboChart() {
            var chart = new google.visualization.ComboChart(document.getElementById('chart_div'));
            var data = google.visualization.arrayToDataTable([
                ['Month', 'Bolivia', 'Ecuador'],
                ['2004/05',  523,      523],
                ['2005/06',  677,      677],
                ['2006/07',  365,      365],
                ['2007/08',  766,      766],
                ['2008/09',  546,      546]
            ]);
            var options = {
                itle : 'Monthly Coffee Production by Country',
                width :600,
                height :400,
                vAxis: {title: 'Cups'},
                hAxis: {title: 'Month'},
                seriesType: 'bars',
                series: {1: {type: 'line'}}
            };
            worker(chart, data, options);
        }

        function worker(chart, data, options) {
            getData(function(result) {
                // var data = setupData(result);
                chart.draw(data, options);
                // setInterval(function() {
                //     getData(function(result) {
                //         var data = setupData(result);
                //         var options = getOptions();
                //         chart.draw(data, options);
                //     });
                // }, 10000);
            });
        }

        function setupData(result) {
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Topping');
            data.addColumn('number', 'Slices');
            // data.addColumn('number', 'Cost');
            for (var index in result) {
                var row = result[index];
                // data.addRow([row.colName, row.slices, row.cost]);
                data.addRow([row.colName, row.slices]);
            }
            
            return data;
        }

        function getOptions() {
            return  {
                'title':'How Much Pizza I Ate Last Night',
                'width':600,
                'height':400,
                animation:{
                    duration: 700,
                    easing: 'out',
                },
                tooltip:{
                    trigger:'selection'
                }
            };
        }
  
        // Callback that creates and populates a data table,
        // instantiates the pie chart, passes in the data and
        // draws it.
        // function drawChart() {
  
        //   // Create the data table.
        //   var data = new google.visualization.DataTable();
        //   data.addColumn('string', 'Topping');
        //   data.addColumn('number', 'Slices');
        //   data.addColumn('number', 'Cost');
        //   data.addRows([
        //     ['Mushrooms', 3, 50],
        //     ['Onions', 1, 20],
        //     ['Olives', 1, 30],
        //     ['Zucchini', 1, 12],
        //     ['Pepperoni', 2, 16]
        //   ]);
  
        //   // Set chart options
        //   var options = {'title':'How Much Pizza I Ate Last Night',
        //                  'width':400,
        //                  'height':300};
  
        //   // Instantiate and draw our chart, passing in some options.
        //   var pChart = new google.visualization.PieChart(document.getElementById('chart_div'));
        //   pChart.draw(data, options);

        //   var lChart = new google.visualization.LineChart(document.getElementById('chart_div2'));
        //   lChart.draw(data, options);

        //   var cChart = new google.visualization.ColumnChart(document.getElementById('chart_div3'));
        //   cChart.draw(data, options);
        // }
      </script>
    </head>
  
    <body>
      <!--Div that will hold the pie chart-->
      <div id="chart_div">update</div>Update
      <div id="chart_div2"></div>
      <div id="chart_div3"></div>
    </body>
  </html>